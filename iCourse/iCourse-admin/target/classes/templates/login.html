<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>登录iCourse</title>
    <link rel="stylesheet" th:href="@{/Sys/css/layui.css}">
    <link rel="stylesheet" th:href="@{/Sys/css/sign.css}">
    <link rel="stylesheet"
          th:href="@{/Sys/js/css/modules/layui-icon-extend/iconfont.css}">
    <link rel="shortcut icon" th:href="@{/favicon.ico}" type="image/x-icon" />
    <link rel="stylesheet" th:href="@{/Sys/css/font.css}">
    <link rel="stylesheet" th:href="@{/Sys/css/xadmin.css}">
    <script type="text/javascript"
            th:src="@{/Sys/js/jquery-3.3.1.min.js}"></script>

    <script th:src="@{/Sys/lib/layui/layui.js}" charset="utf-8"></script>
    <script type="text/javascript" th:src="@{/Sys/js/xadmin.js}"></script>

    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.js"></script>
</head>
<body class="layui-unselect lau-sign-body"
      th:style="'background-image: url(./Sys/images/mybg.jpg); background-repeat: no-repeat; '">

    <form action="" class="layui-form" id="myForm">
        <div class="layui-form layui-form-pane lau-sign-form">
            <h1 class="lau-sign-title">学生课程管理系统123</h1>
            <p class="lau-sign-subtitle">by WonderfulMorty</p>
            <div class="layui-form-item">
                <label class="layui-form-label"><i
                        class="iconfont layui-icon-extend-bianhao"></i> 账号</label>
                <div class="layui-input-block">
                    <input type="text" name="username" placeholder="请输入用户名"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label"><i
                        class="layui-icon layui-icon-password"></i> 密码</label>
                <div class="layui-input-block">
                    <input type="password" name="psw" placeholder="请输入密码"
                           autocomplete="off" class="layui-input">
                </div>
            </div>

            <div class="layui-form-item" id="loginsub">
                <button type="button" class="layui-btn layui-btn-fluid" lay-submit lay-filter="login">登 录</button>
            </div>
            <div class="layui-form-item lau-sign-other">
                <a href="javascript:;"><i class="layui-icon layui-icon-login-qq"></i></a>
                <a href="javascript:;"><i class="layui-icon layui-icon-login-wechat"></i></a>
                <a href="javascript:;"><i class="layui-icon layui-icon-login-weibo"></i></a>
                <a onclick="goToRes()" class="lau-sign-reg lau-sign-link"></a>
            </div>
        </div>
    </form>
</body>
<script th:src="@{/Sys/js/layui.js}"></script>
<script type="text/javascript" th:inline="javascript">
    var idendata = "";
    $(function() {
        layui.use('form', function() {
            var form = layui.form;
            //监听提交
            form.on('submit(login)', function(data) {
                var loginjson = JSON.stringify(data.field);
                var logindata = JSON.parse(loginjson);

                    $.ajax({
                        url : "login",
                        data : logindata,
                        type : 'POST',
                        success : function(data) {
                            if (data != "fail") {
                                layer.msg("登录成功！！！", function() {
                                    if (logindata.username == 'admin') {
                                        location.href="adminIndex"
                                    } else {
                                        location.href="index"
                                    }
                                });
                            } else {
                                layui.use('layer', function() {
                                    var layer = layui.layer;
                                    layer.open({
                                        type : 4,
                                        content : [ "账号或者密码错误",
                                            "#loginsub" ],
                                        shade : 0,
                                        tips : [ 2, '#c00' ],
                                        closeBtn : 0,
                                        time : 2000,
                                    })
                                });
                            }
                        }
                    });
            });
        });

    });

    function goToRes() {

        layui.use('layer', function() {
            var layer = layui.layer;
            if (idendata == null || idendata == "") {
                layer.open({
                    type : 4,
                    content : [ "没有选择身份", "#myradio" ],
                    shade : 0,
                    tips : [ 4, '#91d' ],
                    closeBtn : 0,
                    time : 2000,
                })

            } else if (idendata == 0) {
                layer.open({
                    type : 4,
                    content : [ "管理员不能被注册", "#myradio" ],
                    shade : 0,
                    tips : [ 4, '#91d' ],
                    closeBtn : 0,
                    time : 2000,
                });
            }
            else if (idendata == 1){
                layer.open(
                    {
                        type: 2,
                        title: '增加页面',
                        skin: 'layui-layer-lan',
                        shadeClose: false,
                        shade: 0.8,
                        area:  ['700px', '450px'],
                        resize:true,
                        content:'teaAdd',
                        end: function(){
                            window.location.reload(); //刷新父页面
                        }
                    });
            }
            else if (idendata == 2){
                layer.open(
                    {
                        type: 2,
                        title: '增加页面',
                        skin: 'layui-layer-lan',
                        shadeClose: false,
                        shade: 0.8,
                        area:  ['700px', '450px'],
                        resize:true,
                        content:'stuAdd',
                        end: function(){
                            window.location.reload(); //刷新父页面
                        }
                    });
            }

        });

    }
</script>
</html>